digraph {
    ranksep=1 nodesep=1 rankdir=BT
    node [ shape = none ]
    /*
    subgraph cluster0 {
        user_log_old [ label="{user_log|pk\lemail\laction\lts\l}" ]
        users_old [ label="{users|pk\lusername\lemail\ldownload_count\lswefreq_admin\laffiliation\lfull_user\lcreate_date\lcountry\lnewsletter\l}" ]
        label = "Old schema"
    }
    */
        user [ label=<<table border="1" cellborder="0" align="left">
            <tr><td border="1" sides="b"><b>user</b></td></tr>
            <tr><td align="left" port="pk">user_pk</td></tr>
            <tr><td align="left">username</td></tr>
            <tr><td align="left" port="email">email</td></tr>
            <tr><td align="left">affiliation</td></tr>
            <tr><td align="left">create_date</td></tr>
            <tr><td align="left">country</td></tr>
            </table>> ];

        dataset [ label=<<table border="1" cellborder="0">
            <tr><td border="1" sides="b"><b>dataset</b></td></tr>
            <tr><td align="left" port="pk">dataset_pk</td></tr>
            <tr><td align="left">browswer_uri</td></tr>
            <tr><td align="left">beacon_uri</td></tr>
            </table>> ];

        user_log [ label=<<table border="1" cellborder="0">
            <tr><td border="1" sides="b"><b>user_log</b></td></tr>
            <tr><td align="left" port="pk">user_log_pk</td></tr>
            <tr><td align="left" port="user_pk">user_pk</td></tr>
            <tr><td align="left" port="dataset">dataset_pk</td></tr>
            <tr><td align="left">action</td></tr>
            <tr><td align="left">ts</td></tr>
            </table>> ];

        dataset_access [ label=<<table border="1" cellborder="0">
            <tr><td border="1" sides="b"><b>dataset_access</b></td></tr>
            <tr><td align="left" port="pk">dataset_access_pk</td></tr>
            <tr><td align="left" port="dataset">dataset_pk</td></tr>
            <tr><td align="left" port="user">user_pk</td></tr>
            <tr><td align="left">admin</td></tr>
            <tr><td align="left">consented</td></tr>
            </table>> ];


        dataset_version [ label=<<table border="1" cellborder="0">
            <tr><td border="1" sides="b"><b>dataset_version</b></td></tr>
            <tr><td align="left" port="pk">dataset_version_pk</td></tr>
            <tr><td align="left" port="dataset">dataset_pk</td></tr>
            <tr><td align="left">name</td></tr>
            <tr><td align="left">description</td></tr>
            <tr><td align="left">terms</td></tr>
            </table>> ];

        dataset_file [ label=<<table border="1" cellborder="0">
            <tr><td border="1" sides="b"><b>dataset_file</b></td></tr>
            <tr><td align="left" port="pk">dataset_file_pk</td></tr>
            <tr><td align="left" port="dv">dataset_version_pk</td></tr>
            <tr><td align="left">name</td></tr>
            <tr><td align="left">uri</td></tr>
            </table>> ];
    

        user_log:user_pk -> user:pk;
        dataset_access:user -> user:pk
        dataset_access:dataset -> dataset:pk
        dataset_version:dataset -> dataset:pk
        dataset_file:dv -> dataset_version:pk
        user_log:dataset -> dataset:pk

}
