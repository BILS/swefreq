<div class="container">
    <span class="btn-group" ng-click="ctrl.filterVariantsBy($event)">
        <button class="btn btn-primary active" value="[]">All</button>
        <button class="btn btn-primary" value='["missense", "lof"]'>Missense + LoF</button>
        <button class="btn btn-primary" value='["lof"]'>LoF</button>
    </span><br/>
    <a ng-if="ctrl.item" class="btn btn-success" href="/api/datasets/{{ctrl.dataset.shortName}}/browser/download/{{ctrl.itemType}}/{{ctrl.item}}">Export table to CSV</a><br/>
    <span class="label label-info">&dagger; denotes a consequence that is for a non-canonical transcript</span>
</div>
<table class="table table-sm table-striped table-condensed small">
    <thead>
        <tr>
            <th ng-repeat="header in ctrl.headers">
                <a href="#" ng-click="ctrl.reorderVariants(header[0]);">
                    <span ng-show="ctrl.orderByField == header[0]">
                        <span ng-show="!ctrl.reverseSort" class="glyphicon glyphicon-triangle-top"></span>
                        <span ng-show="ctrl.reverseSort" class="glyphicon glyphicon-triangle-bottom"></span>
                    </span>
                    {{ header[1] }}
                </a>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat="variant in ctrl.filteredVariants | orderBy:ctrl.orderByField:ctrl.reverseSort">
            <td ng-repeat="header in ctrl.headers"
                ng-switch="header[0]"
                ng-class="{'synonymous':'bg-success',
                           'splice region':'bg-success',
                           'missense':'bg-warning',
                           'inframe deletion':'bg-warning',
                           'inframe insertion':'bg-warning'}[variant[header[0]]]">
                <div ng-switch-when="variantId">
                    <a href="{{ ctrl.browserLink('variant/' + variant[header[0]] ) }}">
                        {{ variant[header[0]].split("-")[0] }}-{{ variant[header[0]].split("-")[1] }}
                        {{ variant[header[0]].split("-")[2] | shortSeq }}
                        &rarr;
                        {{ variant[header[0]].split("-")[3] | shortSeq }}
                        <span ng-if="variant['rsid']">({{ variant["rsid"] }})</span>
                    </a>
                </div>
                <div ng-switch-when="HGVS">
                    {{ variant[header[0]]}}
                    <span ng-if="variant[header[0]] && variant['CANONICAL'] != 'YES'" title="Non-canonical">
                        &dagger;
                    </span>
                </div>
                <div ng-switch-when="alleleFreq">
                    <span style="color: steelblue; white-space: nowrap">
                        &#9632;
                        {{ variant['alleleCount'] > 1 ? "&#9632;" : "&#9633;" }}
                        {{ variant[header[0]] > 0.0001 && variant['alleleCount'] > 1 ? "&#9632;" : "&#9633;" }}
                        {{ variant[header[0]] > 0.001  && variant['alleleCount'] > 1 ? "&#9632;" : "&#9633;" }}
                        {{ variant[header[0]] > 0.01   && variant['alleleCount'] > 1 ? "&#9632;" : "&#9633;" }}
                        {{ variant[header[0]] > 0.05   && variant['alleleCount'] > 1 ? "&#9632;" : "&#9633;" }}
                        {{ variant[header[0]] > 0.5    && variant['alleleCount'] > 1 ? "&#9632;" : "&#9633;" }}
                    </span><br/>
                    {{ variant[header[0]] | number : 4 }}
                </div>
                <div ng-switch-default>
                    {{ variant[header[0]] }}
                </div>
            </td>
        </tr>
    </tbody>
</table>
